Leo Handler (Mark Wahlberg) rides the subway to his mother's house in Queens, New York, where she throws a surprise party in honor of his parole.
His cousin Erica (Charlize Theron) is at the party with her boyfriend Willie Gutierrez (Joaquin Phoenix). Willie takes Leo aside and thanks him for serving time in prison, implying that Leo had taken a fall for their gang of friends.
Leo is eager to find a job to support his mother (Ellen Burstyn), who has a heart condition.
Willie suggests working for Erica's stepfather Frank Olchin (James Caan).
The next day, at the railway car repair company Frank owns, Leo is encouraged to enter a 2-year machinist program and Frank offers to help finance his studies.
Needing to work right away, Leo asks about working with Willie for the company but Frank discourages that idea.
Leo is advised by Willie not to worry about it, saying Frank tried to get him into a machinist program as well.
At Brooklyn Borough Hall, Willie explains how corrupt the contract system is for repair work on the subway.
After a hearing to award contracts, Willie is approached by Hector Gallardo (Robert Montano) about leaving Frank's firm for his.
Willie brushes him off, taking Leo with him to Roosevelt Island, where he bribes an official in charge of awarding contracts.
One night, Willie takes Leo to a rail yard, where he and a gang sabotage the work of Gallardo's firm in order to lower their quality rating and lessen their ability to get contracts.
Leo is told to stand watch while the crew sabotages the train couplings.
Willie heads into the yard master's office to pay him off with Knicks tickets, but is told to get his crew off the tracks, Gallardo having brought him $2,000 in cash.
The yard master sounds the alarm, which draws a police officer.
Terrified of returning to jail, Leo tries to run.
When the cop begins to hit Leo with his night stick, Leo beats him into unconsciousness.
As he runs off, he sees Willie kill the yard master.
With the cop in a coma at a hospital, the crew tells Leo that he must murder the officer to prevent him from identifying Leo when he wakes up.
If the cop lives, Leo's the one who will be killed.
Leo flees.
When the cop awakes, he identifies Leo as his attacker, triggering a broad manhunt.
The police assume Leo is also responsible for the yard master's murder.
When they raid his mother's apartment, she has a heart attack, leaving her in an even weaker state.
Even though Willie has told him to lay low, Leo emerges from hiding to visit his sick mother.
Erica is tending to her.
She finds out Willie was with him at the yards and realizes it was Willie who actually killed the yard master.
She breaks off their engagement.
Erica implores her stepfather Frank to help, but instead Leo realizes that Frank is prepared to kill him.
Out of options, Leo turns to Gallardo for protection.
With Gallardo's lawyers at his side, Leo turns himself in at a public hearing into the rail yard incident and contract corruption.
Realizing that the injured cop's testimony against Leo is in no one's interest, Frank and Gallardo negotiate a new split of the contracts with the Queens Borough President (Steve Lawrence) in a backroom deal.
Willie goes to see Erica, trying to win her back.
Frank has told him that Erica and Leo had been in love when they were younger, and once were caught having sex.
Fearful of his temper and jealousy, Erica triggers the silent house alarm.
Willie tries to embrace her, but as she pulls away, he accidentally throws Erica off the second floor landing, causing her to fall to her death.
Outside the house, he surrenders to police who have responded to the alarm.
Police enter the hearing to inform Erica's mother Kitty (Faye Dunaway) and stepfather Frank of the incident at the house, and the discovery of Erica's body.
After his stepdaughter's funeral, Frank takes Leo aside to promise help in the future.
After turning away in muted disgust, Leo joins the grieving Kitty and the rest of the family in an embrace of support.
Leo then leaves Queens on the elevated train.
(Note: A non-director's cut of the film ended with Leo testifying against Frank and his company, rejecting the deal.
The version currently available on the Miramax DVD in the US is the director's cut.)